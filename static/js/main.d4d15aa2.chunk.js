(this.webpackJsonpearthquakes=this.webpackJsonpearthquakes||[]).push([[0],{112:function(e,t,a){e.exports=a(149)},117:function(e,t,a){},122:function(e,t,a){},149:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(10),i=a.n(r),l=(a(117),a(59)),c=(a(122),a(28)),s=a(186),u=a(180),g=a(187),d=a(188),m=a(177),h=a(150),p=a(182),f=a(196),y=a(89),v=a(44),b=a(90),E={user_id:"",api_key:"",user_name:"",email:"",isLoggedIn:!1},k=Object(v.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(console.log("action ",t),t.type){case"LOGIN":return e=t.payload;case"LOGOUT":return E;default:return e}}),Object(b.composeWithDevTools)()),S=a(78),O=Object(m.a)((function(e){return{paper:{position:"absolute",width:"35%",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),marginLeft:"30%",marginRight:"35%",marginTop:"10%"}}}));Object(l.b)((function(e,t){return{user:e,handleOpen:t.handleOpen}}),(function(e){return{handleLogin:function(t){return e({type:"LOGIN",payload:t})},handleLogout:function(){return e({type:"LOGOUT"})}}}))((function(e){var t=e.user,a=e.handleOpen,r=e.handleLogin,i=e.handleLogout,l=O(),s=Object(n.useState)(""),g=Object(c.a)(s,2),d=g[0],m=g[1];Object(n.useEffect)((function(){/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(d.toLowerCase())?q(!0):q(!1)}),[d]);var v=Object(n.useState)(""),b=Object(c.a)(v,2),E=b[0],_=b[1];Object(n.useEffect)((function(){E.length>0?B(!0):B(!1)}),[E]);var w=Object(n.useState)(""),D=Object(c.a)(w,2),j=D[0],T=D[1];Object(n.useEffect)((function(e){console.log(e)}),[j]);var F=Object(n.useState)(!1),C=Object(c.a)(F,2),L=C[0],q=C[1],A=Object(n.useState)(!1),P=Object(c.a)(A,2),x=P[0],B=P[1],I=Object(n.useState)(k.getState()),M=Object(c.a)(I,2),z=M[0],R=M[1];Object(n.useEffect)((function(){console.log(z)}),[z]);var G=function(){return t.isLoggedIn?o.a.createElement(o.a.Fragment,null,o.a.createElement("h4",null,"Welcome ",t.user_name,"!"),o.a.createElement(u.a,{onClick:function(){i()}},"Logout"),o.a.createElement("h1",null,"Earthquakes")):o.a.createElement(h.a,{className:l.paper},o.a.createElement("h2",null,"Log In to Planet Labs"),o.a.createElement(p.a,null,o.a.createElement(f.a,{required:!0,name:"email",placeholder:"Email",variant:"outlined",onChange:function(e){!function(e){m(e.target.value)}(e)},value:d}),o.a.createElement(f.a,{required:!0,name:"password",placeholder:"Password",type:"password",variant:"outlined",onChange:function(e){!function(e){_(e.target.value)}(e)},value:E}),o.a.createElement(u.a,{disabled:!L&&!x,onClick:function(){return a(),void S.login(d,E).then((function(e){var t=Object(y.a)(e);if(t){var a={user_id:t.user_id,api_key:t.api_key,user_name:t.user_name,email:t.email,isLoggedIn:!0};r(a,(function(){R(k.getState)}))}})).catch((function(e){console.log(e),400===e.status?T(e.errors.email[0]):401===e.status&&T(e.body.message)}))}},"Login")))};return o.a.createElement(G,null)}));console.log("user_id",k.getState().user_id);var _=Object(m.a)((function(e){return{title:{flexGrow:1},center:{margin:"0 auto"}}})),w=function(){var e=_(),t=Object(n.useState)(!1),a=Object(c.a)(t,2);a[0],a[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,null,o.a.createElement(d.a,null,o.a.createElement(s.a,{variant:"h6",className:e.title},"Disasters"))))},D=a(95),j=a(190),T=a(56),F=a(57),C=a(61),L=a(60),q=a(198),A=a(192),P=a(201),x=a(94),B=a(17),I=a(191);var M=a(194),z=a(200),R=a(189),G=a(16),U=a.n(G),N=function(e){Object(C.a)(n,e);var t=Object(L.a)(n);function n(e){var o;return Object(T.a)(this,n),(o=t.call(this,e)).iconDot=new U.a.Icon({iconUrl:a(83),iconRetinaUrl:a(83),iconAnchor:null,popupAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null,iconSize:new U.a.Point(25,25),className:"dummy"}),o.state={position:[e.long,e.lat],zoom:e.zoom},o}return Object(F.a)(n,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(M.a,{style:{width:"225px",height:"225px",display:"inline-block"},center:this.state.position,zoom:this.state.zoom,doubleClickZoom:!1,closePopupOnClick:!1,dragging:!0,zoomSnap:!1,zoomDelta:!1,zoomControl:!1,trackResize:!1,touchZoom:!1,scrollWheelZoom:!1,attributionControl:!1},o.a.createElement(z.a,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png"}),o.a.createElement(R.a,{icon:this.iconDot,position:this.state.position})))}}]),n}(n.Component),K=a(133),W=a(140);var Z=a(142),Y=Z.auth,J=Z.items,H=Z.filter,X=function(e){Object(C.a)(a,e);var t=Object(L.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).handleDateChange=function(e){var t=new Date(e);t.setDate(t.getDate()+1),n.setState({dateFrom:e,dateTo:t},(function(){n.getUSGS()}))},n.handleMagnitudeChange=function(e){n.setState({magnitude:e.target.value},(function(){n.getUSGS()}))},n.Earthquake=function(e){console.log(e);var t=function(e,t){var a=W();return new K(a).hasContainers({type:"Point",coordinates:[t,e]})}(e.point[1],e.point[0])?"Sea":"Land";return o.a.createElement(o.a.Fragment,{key:e.id},o.a.createElement(h.a,{style:{padding:"2%",paddingBottom:"-2%",margin:"5%",overflow:"hidden"}},o.a.createElement(N,{key:"".concat(e.point[1],"/").concat(e.point[0]),lat:e.point[1],long:e.point[0],zoom:3}),o.a.createElement("div",{style:{display:"inline-block",marginLeft:"5%",verticalAlign:"top"}},o.a.createElement(s.a,{variant:"h5"},e.title),o.a.createElement(s.a,{variant:"body1"},o.a.createElement("strong",null,"Magnitude:")," ",e.magnitude),o.a.createElement(s.a,{variant:"body1"},o.a.createElement("strong",null,"Place:")," ",e.place),o.a.createElement(s.a,{variant:"body1"},o.a.createElement("strong",null,"Time of earthquake:")," ",e.time),o.a.createElement(s.a,{variant:"body1"},o.a.createElement("strong",null,"Coordinates of earthquake:")," ",e.point[0],"\xb0N, ",e.point[1],"\xb0E"),o.a.createElement(s.a,{variant:"body1"},o.a.createElement("strong",null,"Land or Sea:")," ",t))))},n.d=new Date,n.state={item_id:void 0,item_url:void 0,earthquakes:[],dateFrom:new Date("".concat(n.d.getFullYear(),"-").concat(n.twoDigits(n.d.getMonth()+1),"-").concat(n.twoDigits(n.d.getDate()-1),"T").concat(n.twoDigits(n.d.getHours()),":").concat(n.twoDigits(n.d.getMinutes()),":").concat(n.twoDigits(n.d.getSeconds()))),dateTo:new Date("".concat(n.d.getFullYear(),"-").concat(n.twoDigits(n.d.getMonth()+1),"-").concat(n.twoDigits(n.d.getDate()),"T").concat(n.twoDigits(n.d.getHours()),":").concat(n.twoDigits(n.d.getMinutes()),":").concat(n.twoDigits(n.d.getSeconds()))),magnitude:5},n.key=Object({NODE_ENV:"production",PUBLIC_URL:"/disasters",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_KEY,n.search4Band(),n.getUSGS(),n}return Object(F.a)(a,[{key:"twoDigits",value:function(e){return(e<10?"0":"")+e}},{key:"useKey",value:function(){Y.setKey(k.getState().api_key)}},{key:"search4Band",value:function(){var e=this,t={types:["PSScene4Band"],filter:H.geometry("geometry",{type:"Polygon",coordinates:[[[-122.52811431884767,37.665342132088284],[-122.34683990478516,37.665342132088284],[-122.34683990478516,37.81493737606794],[-122.52811431884767,37.81493737606794],[-122.52811431884767,37.665342132088284]]]}),limit:10};J.search(t).then((function(t){console.log(t);var a="".concat(t[0]._links.thumbnail,"?api_key=").concat(e.key);e.setState({item_id:t[0].id,item_url:a})}))}},{key:"getDate",value:function(){var e,t=this.state.earthquakes[0].time;switch((t=t.split(" "))[1]){case"Jan":e="01";break;case"Feb":e="02";break;case"Mar":e="03";break;case"Apr":e="04";break;case"May":e="05";break;case"Jun":e="06";break;case"Jul":e="07";break;case"Aug":e="08";break;case"Sept":e="09";break;case"Oct":e="10";break;case"Nov":e="11";break;default:e="12"}var a=parseInt(t[2]),n=t[3];return["".concat(n,"-").concat(e,"-").concat(a-2,"T00:00:00.000Z"),"".concat(n,"-").concat(e,"-").concat(a+2,"T23:59:59.999Z")]}},{key:"pointToBBOX",value:function(e,t){return[[[e-.2,t+.2],[e+.2,t+.2],[e-.2,t-.2],[e+.2,t-.2],[e-.2,t+.2]]]}},{key:"getUSGS",value:function(){var e=this,t=this.getDateTwoDaysAgo(),a=t.year,n=t.month,o=t.date;console.log("today",a,n,o);var r="".concat(this.state.dateFrom.getFullYear(),"-").concat(this.state.dateFrom.getMonth(),"-").concat(this.state.dateFrom.getDate()),i="".concat(this.state.dateTo.getFullYear(),"-").concat(this.state.dateTo.getMonth(),"-").concat(this.state.dateTo.getDate());fetch("https://earthquake.usgs.gov/fdsnws/event/1/query?minmagnitude=".concat(this.state.magnitude,"&format=geojson&limit=10&starttime=").concat(r,"&endtime=").concat(i),{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"}).then((function(e){return e.json()})).then((function(t){console.log("USGS",t);var a=t.features;if(a===[]);else{for(var n=[],o=0;o<a.length;o++){console.log("coord",a[o].geometry.coordinates[0],a[o].geometry.coordinates[1]);var r={id:o,time:new Date(a[o].properties.time).toDateString(),magnitude:a[o].properties.mag,title:a[o].properties.title,place:a[o].properties.place,point:[a[o].geometry.coordinates[1],a[o].geometry.coordinates[0]],bbox:e.pointToBBOX(a[o].geometry.coordinates[0],a[o].geometry.coordinates[1]),type:a[o].properties.earthquake};n.push(r),console.log("time",r.time)}e.setState({earthquakes:n},(function(){console.log(e.state),e.getExplorerSites()}))}}))}},{key:"getExplorerSites",value:function(){if(this.state.earthquakes.length>0){var e=function(e,t){return{search_filter:{type:"AndFilter",config:[{type:"GeometryFilter",field_name:"geometry",config:e},{type:"OrFilter",config:[{type:"AndFilter",config:[{type:"StringInFilter",field_name:"item_type",config:["PSScene4Band"]},{type:"RangeFilter",field_name:"sun_elevation",config:{gte:0,lte:90}}]},{type:"AndFilter",config:[{type:"StringInFilter",field_name:"item_type",config:["REOrthoTile"]},{type:"RangeFilter",field_name:"sun_elevation",config:{gte:0,lte:90}}]},{type:"AndFilter",config:[{type:"StringInFilter",field_name:"item_type",config:["SkySatCollect"]},{type:"RangeFilter",field_name:"sun_elevation",config:{gte:0,lte:90}}]}]},{type:"OrFilter",config:[{type:"DateRangeFilter",field_name:"acquired",config:{gte:t[0],lte:t[1]}}]}]},item_types:["REOrthoTile","PSScene4Band","SkySatCollect"]}}({type:"Polygon",coordinates:this.pointToBBOX(this.state.earthquakes[0].point[0],this.state.earthquakes[0].point[1])},this.getDate()),t=e.search_filter,a=e.item_types;k.getState().isLoggedIn&&(this.useKey(),J.search({filter:t,types:a}).then((function(e){console.log("response",e)})))}}},{key:"getDateTwoDaysAgo",value:function(){var e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()-2}}},{key:"render",value:function(){var e=this,t=this.state.earthquakes.map((function(t){return e.Earthquake(t)}));return 0===t.length&&(t=o.a.createElement("p",{style:{textAlign:"center",marginTop:"20%"}},"No Results")),o.a.createElement(o.a.Fragment,null,o.a.createElement(B.a,{utils:x.a},o.a.createElement("div",{style:{height:"64px"}}),o.a.createElement("div",{style:{margin:"0% 5% 0% 5%"}},o.a.createElement(I.a,{margin:"normal",variant:"inline",id:"date-picker-dialog",label:"Select a Date",format:"MM/dd/yyyy",value:this.state.dateFrom,onChange:this.handleDateChange,KeyboardButtonProps:{"aria-label":"change date"}}),o.a.createElement(p.a,{style:{margin:"15px"}},o.a.createElement(q.a,{shrink:!0,id:"demo-simple-select-placeholder-label-label"},"Magnitude"),o.a.createElement(A.a,{labelId:"demo-simple-select-placeholder-label-label",id:"demo-simple-select-placeholder-label",value:this.state.magnitude,onChange:this.handleMagnitudeChange,displayEmpty:!0},o.a.createElement(P.a,{value:1},"1"),o.a.createElement(P.a,{value:2},"2"),o.a.createElement(P.a,{value:3},"3"),o.a.createElement(P.a,{value:4},"4"),o.a.createElement(P.a,{value:5},"5"),o.a.createElement(P.a,{value:6},"6"),o.a.createElement(P.a,{value:7},"7+")))),t))}}]),a}(n.Component);var $=function(){var e=Object(D.a)({palette:{primary:{light:"#8eacbc",main:"#607d8c",dark:"#34515f",contrastText:"#fff"},secondary:{light:"#ffa4a2",main:"#e57373",dark:"#af4448",contrastText:"#000"}}});return o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a,{theme:e},o.a.createElement(l.a,{store:k},o.a.createElement(w,null),o.a.createElement(X,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},83:function(e,t,a){e.exports=a.p+"static/media/redmarker.d1b34539.svg"}},[[112,1,2]]]);
//# sourceMappingURL=main.d4d15aa2.chunk.js.map